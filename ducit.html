<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Presentation at Ducit &mdash; Part 1</title>

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/simple.css" id="theme">
    <link rel="stylesheet" href="style.css">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>
  </head>
  <body>
    <div id="hidden" style="display:none;">
      <div id="static-content">
        <div class="footer">
          <!-- <p>University of Sussex</p> -->
          <img src="images/sussex_logo.svg" style="max-width: 10%; border: none; box-shadow: none; margin: 0;"/>
        </div>
      </div>
    </div>
    <div class="reveal">
<div class="slides">

<section>
<h1>Fair Predictions</h1>

<p>by <b>Thomas Kehrenberg</b> and <b>Oliver Thomas</b> </p>

<img src="images/Cifas_logo.jpg" alt="Cifas Logo" style="width: 15%; border: none;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<img src="images/ducit_logo.jpg" alt="Ducit Logo" style="width: 15%; border: none;">
<p>Talk given at Cifas in association with Ducit</p>

<br/>

<p>Mon, 15<sup>th</sup> April 2019</p>

<!-- <img src="images/sussex_logo.svg" style="width: 15%; border: none;"/> -->
</section>

<section>
  <section data-markdown><textarea data-template>
    ## Common Notation
  </textarea></section>
  <section data-markdown><textarea data-template>
    ## Common Notation

    - $Y \in \\{0,...,n\\}$: Class label
    - $S \in \\{0,...,k\\}$: Sensitive label
    - $X = (X_1, ... , X_m)$: Features of a datapoint (Covariates)
    - $\theta$: Model parameters we learn.
  </textarea></section>
  <section data-markdown><textarea data-template>
    ## Common Notation

    $\hat{Y}=$ Model's prediction of $Y$
    
    $\hat{S}=$ Model's prediction of $S$
    
    $\hat{X}=$ Model's prediction of $X$
  </textarea></section>
</section>

<section>
  <section data-markdown><textarea data-template>
  ## Example Dataset: UCI Adult

  U.S. census data from 1994

  $Y=$ Does the individual earn > $\$50,000$?
  
  $S=$ Is the individual white?
  
  $X=$ Features of the individual: relationship status, age, education level, hours worked per week etc.
  </textarea></section>

  <!--
  <section data-markdown><textarea data-template>
  ## Sensitive attributes

  - what is a sensitive attribute?
  - also known as protected characteristics.
  </textarea></section>
  -->
</section>

<section data-markdown><textarea data-template>
## Confusion matrix

|                 | $y=1$               | $y=0$               |
|-----------------|:-------------------:|:-------------------:|
| **$\hat{y}=1$** | true positive (TP)  | false positive (FP) |
| **$\hat{y}=0$** | false negative (FN) | true negative (TN)  |

<br/>

**acceptance rate**: $AR = P(\hat{y}=1) = \frac{TP + FP}{TP + FP + FN + TN}$

**true positive rate**: $TPR = P(\hat{y}=1|y=1) = \frac{TP}{TP + FN}$
</textarea></section>

<section>
    <section data-markdown><textarea data-template>
    ## Fairness definitions: 
    ### Group Fairness
    ### Individual Fairness
    </textarea></section>
    
    <section data-markdown><textarea data-template>
    ## Definitions &ndash; Group Fairness
    ### Demographic Parity

    Make (positive) predictions at the same rate across different subgroups.

    $$
      P(\hat{Y} = 1 | S=0) = P(\hat{Y} = 1 | S=1)
    $$

    &rarr; Equalise acceptance rate accross groups.
    </textarea></section>
    
    <section data-markdown><textarea data-template>
    ## Definitions &ndash; Group Fairness 
    ### Equal Odds

    Make (positive) predictions at the same rate across different subgroups, conditioned on the known outcome.

    $$
    P(\hat{Y}=y | S=0, Y=y) = P(\hat{Y}=y | S=1, Y=y)
    $$

    with $Y \in \\{0,1\\}$

    &rarr; Equalise the TPR and the TNR (or FPR) across groups.
    </textarea></section>

    <section data-markdown><textarea data-template>
    ## Definitions &ndash; Group Fairness
    ### Equal Opportunity

    Make (positive) predictions at the same rate across different subgroups, conditioned on if the known outcome is positive.

    $$
      P(\hat{Y} = 1 | S=0, Y=1) = P(\hat{Y} = 1 | S=1, Y=1)
    $$

    &rarr; Equalise the TPR across groups.
    </textarea></section>
</section>

<section>
    <section data-markdown><textarea data-template>
    ## Fairness definitions: 
    ### Individual Fairness

    > Similar individuals should be treated similarly.

    Given some distance measure between individuals (e.g. the Euclidean distance in the feature space),
    the distance between individuals and the distance of their associated outcome should be proportional.
    </textarea></section>
</section>

<section>
  <section data-markdown><textarea data-template>
  ## How bias gets into the dataset
  ### Sampling Bias
  <img src="images/sampling_1.svg" alt="Data Generation Pipeline" style="width: 50%; border: none; box-shadow: none;">
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## How bias gets into the dataset
  ### Sampling Bias
  <img src="images/sampling_2.svg" alt="Data Generation Pipeline" style="width: 50%; border: none; box-shadow: none;">
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## How bias gets into the dataset
  ### Sampling Bias
  <img src="images/sampling_3.svg" alt="Data Generation Pipeline" style="width: 50%; border: none; box-shadow: none;">
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## How bias gets into the dataset
  ### Sampling Bias
  This can occur because of instead of drawing i.i.d. (independent and identically distributed), we are instead drawing d.d.d. (depedent and differently distributed)
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## How bias gets into the dataset
  ### Unfairness
  <br/> 
  <img src="images/data_generation.svg" alt="Data Generation Pipeline" style="width: 50%; border: none;"> 
  </textarea></section>
</section>

<section data-markdown><textarea data-template>
## Fairness-accuracy trade-off

If the class label is <em>unfair</em>, or the features themselves are unfair, then it cannot be possible to be both fair and accurate.

However, if bias solely occurs due to sampling bias, then fairness should improve generalisation.
<!-- Not sure about the above statement, will have a think -->
</textarea></section>

<section data-markdown><textarea data-template>
## In-process methods

- Enforce fairness *during training*
- Example: Logistic Regression
  * model: $\; f(x) = Wx + b$, $\; \theta = \\{W, b\\}$
  * probability score: $\; P(y=1|x, \theta)=\sigma(f(x))$
  * with dependency on $s$: $\; P(y=1|x, \theta, s)$
</textarea></section>

<section>
  <section data-markdown><textarea data-template>
  ## In-process: Likelihood

  - Manipulate the likelihood $P(y=1|x, \theta, s)$ to enforce fairness
  - Introduce target labels $\bar{y}$
  - $P(y=1|x, \theta, s) = \sum\limits_{\bar{y}} P(y=1|\bar{y},s)P(\bar{y}|x, \theta, s)$
  - Intuition: change the learning goal

  Paper: *Kehrenberg et al.*, `arXiv:1810.05598`
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## In-process: Likelihood

  - conceptually works best with *Demographic Parity*
     * but was also extended to Equal Odds/Opportunity
  - very transparent and easy to control
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## In-process: Likelihood

  ![results](images/adult_race_PR.png) <!-- .element: style="width: 70%; border: none;"-->
  </textarea></section>
</section>

<section>
  <section data-markdown><textarea data-template>
  ## In-process: Regularization

  - Different approach: add regularization to model parameters so that model will be fair
  - measure of bias in output $f$: $Cov(s, f) \approx \frac{1}{N} \sum\limits_{i=1}^{N} (s_i - \bar{s}) \cdot f_i$
     * assumption: $E[f] =0$ which is fulfilled in the Logistic Regression example

  (this is only for Demographic Parity, but can also work with EO)

  (we want $f$ to be predictive of $y$ but also keep $Cov$ small)
  </textarea></section>

  <section data-markdown><textarea data-template>
  ## In-process: Regularization

  - classification loss: $\; \mathcal{L}_c(y, \sigma(f(x))\;$ (e.g. cross entropy)

  (add the other loss onto this)
  </textarea></section>
</section>

<section>
  <section data-markdown><textarea data-template>
  ## Pre-process
  </textarea></section>
</section>

</div>
    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script src="settings.js"></script>
  </body>
</html>
